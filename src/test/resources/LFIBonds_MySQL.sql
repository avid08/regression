SELECT MAX(case when identity_name = 'AgentID' then convert(identity_value, unsigned integer) end) as AgentID ,
MAX(case when element_type = 'FC_LFYHYID' then element_value end) AS FC_LFYHYID ,
MAX(case when element_type = 'FC_ISSUER_NAME' then element_value end) AS FC_ISSUER_NAME ,
MAX(case when element_type = 'FC_ANNOUNCED_DATE' then element_value end) AS FC_ANNOUNCED_DATE ,
MAX(case when element_type = 'FC_ROAD_SHOW_DATE' then element_value end) AS FC_ROAD_SHOW_DATE ,
MAX(case when element_type = 'FC_PRICING_DT' then element_value end) AS FC_PRICING_DT,
MAX(case when element_type = 'FC_BOND_PURPOSE' then element_value end) AS FC_BOND_PURPOSE ,
MAX(case when element_type = 'FC_PURPOSE_DESC' then element_value end) AS FC_PURPOSE_DESC ,
MAX(case when element_type = 'FC_BOND_TYPE' then element_value end) AS FC_BOND_TYPE ,
MAX(case when element_type = 'FC_ISSUE_AMOUNT_FNL' then element_value end) AS FC_ISSUE_AMOUNT_FNL ,
MAX(case when element_type = 'FC_ISSUE_PRICE_FNL' then element_value end) AS FC_ISSUE_PRICE_FNL ,
MAX(case when element_type = 'FC_ISSUE_COUPON_RATE_FNL' then element_value end) AS FC_ISSUE_COUPON_RATE_FNL ,
MAX(case when element_type = 'FC_SPREAD' then element_value end) AS FC_SPREAD ,
MAX(case when element_type = 'FC_YTM' then element_value end) AS FC_YTM ,
MAX(case when element_type = 'FC_DESCRIPTION' then element_value end) AS FC_DESCRIPTION ,
MAX(case when element_type = 'FC_MATURITY_DATE_FNL' then element_value end) AS FC_MATURITY_DATE_FNL ,
MAX(case when element_type = 'FC_TERM' then element_value end) AS FC_TERM ,
MAX(case when element_type = 'FC_NOTES' then element_value end) AS FC_NOTES ,
MAX(case when element_type = 'FC_CALL_PROTECTION' then element_value end) AS FC_CALL_PROTECTION ,
MAX(case when element_type = 'FC_NC_YEARS' then element_value end) AS FC_NC_YEARS ,
MAX(case when element_type = 'FC_CALL_PERCENTAGE' then element_value end) AS FC_CALL_PERCENTAGE ,
MAX(case when element_type = 'FC_1ST_CALL_DT' then element_value end) AS FC_1ST_CALL_DT ,
MAX(case when element_type = 'FC_1ST_CALL_PRICE' then element_value end) AS FC_1ST_CALL_PRICE ,
MAX(case when element_type = 'FC_CALL_SCHEDULE' then element_value end) AS FC_CALL_SCHEDULE ,
MAX(case when element_type = 'FC_EQUITY_CLAW_PERCENTAGE' then element_value end) AS FC_EQUITY_CLAW_PERCENTAGE ,
MAX(case when element_type = 'FC_EQUITY_CLAW_PRICE' then element_value end) AS FC_EQUITY_CLAW_PRICE ,
MAX(case when element_type = 'FC_EQUITY_CLAW_YEARS' then element_value end) AS FC_EQUITY_CLAW_YEARS ,
MAX(case when element_type = 'FC_CHANGE_OF_CONTROL' then element_value end) AS FC_CHANGE_OF_CONTROL ,
MAX(case when element_type = 'FC_SPECIAL_CALL' then element_value end) AS FC_SPECIAL_CALL ,
MAX(case when element_type = 'FC_SIZE_PRLM' then element_value end) AS FC_SIZE_PRLM ,
MAX(case when element_type = 'FC_ISSUE_PRICE_PRLM' then element_value end) AS FC_ISSUE_PRICE_PRLM ,
MAX(case when element_type = 'FC_TALK_PRLM' then element_value end) AS FC_TALK_PRLM ,
MAX(case when element_type = 'FC_MATURITY_DATE_PRLM' then element_value end) AS FC_MATURITY_DATE_PRLM ,
MAX(case when element_type = 'FC_SENIORITY' then element_value end) AS FC_SENIORITY ,
MAX(case when element_type = 'FC_FIXED_FLOATING' then element_value end) AS FC_FIXED_FLOATING ,
MAX(case when element_type = 'FC_CASH_PIK_TOGGLE' then element_value end) AS FC_CASH_PIK_TOGGLE ,
MAX(case when element_type = 'FC_MARKETPLACE' then element_value end) AS FC_MARKETPLACE ,
MAX(case when element_type = 'FC_UNDERWRITER' then element_value end) AS FC_UNDERWRITER ,
MAX(case when element_type = 'FC_SECONDARY' then element_value end) AS FC_SECONDARY ,
MAX(case when element_type = 'FC_DAYS_IN_MARKET' then element_value end) AS FC_DAYS_IN_MARKET ,
MAX(case when element_type = 'FC_DEBUT' then element_value end) AS FC_DEBUT ,
MAX(case when element_type = 'FC_TARGET' then element_value end) AS FC_TARGET ,
MAX(case when element_type = 'FC_OTHER_ID' then element_value end) AS FC_OTHER_ID ,
MAX(case when element_type = 'FC_CONCURRENT_LOAN_ID' then element_value end) AS FC_CONCURRENT_LOAN_ID ,
MAX(case when element_type = 'FC_OWNERSHIP' then element_value end) AS FC_OWNERSHIP ,
MAX(case when element_type = 'FC_EBITDA' then element_value end) AS FC_EBITDA ,
MAX(case when element_type = 'FC_EQUITY_PERCENTAGE' then element_value end) AS FC_EQUITY_PERCENTAGE ,
MAX(case when element_type = 'FC_LEVERAGED_AHEAD_NOTES' then element_value end) AS FC_LEVERAGED_AHEAD_NOTES ,
MAX(case when element_type = 'FC_LEVERAGED_NOTES' then element_value end) AS FC_LEVERAGED_NOTES ,
MAX(case when element_type = 'FC_DOC_SCORE' then element_value end) AS FC_DOC_SCORE ,
MAX(case when element_type = 'FC_TRANSACTION' then element_value end) AS FC_TRANSACTION ,
MAX(case when element_type = 'FC_CHANGE_ON_BREAK' then element_value end) AS FC_CHANGE_ON_BREAK ,
MAX(case when element_type = 'FC_SPECIAL_CALL' then element_value end) AS FC_SPECIAL_CALL ,
MAX(case when element_type = 'FC_SPREAD' then element_value end) AS FC_SPREAD ,
MAX(case when element_type = 'FC_TARGET' then element_value end) AS FC_TARGET ,
MAX(case when element_type = 'FC_TERM' then element_value end) AS FC_TERM ,
MAX(case when element_type = 'FC_TRANSACTION' then element_value end) AS FC_TRANSACTION ,
MAX(case when element_type = 'FC_YTM' then element_value end) AS FC_YTM ,
MAX(case when element_type = 'FC_PERM_ID' then element_value end) AS FC_PERM_ID
FROM transaction_element te JOIN tranche t ON t.id = te.entity_id
  INNER JOIN transaction_role tr  ON tr.transaction_id = t.transaction_id AND tr.transaction_role = 'Issuer'
  INNER JOIN entity_cross_reference ecr ON ecr.entity_id = tr.business_entity_id AND ecr.entity_type = 'Business Entity'  AND ecr.identity_authority = 'Fitch Solutions'
WHERE te.information_provenance = 'levfin'
and te.entity_type = 'Tranche'
and category = 'Bond public data'
GROUP BY te.entity_id
ORDER BY FC_ISSUER_NAME;